"use strict";(()=>{var e={};e.id=7744,e.ids=[7744],e.modules={3524:e=>{e.exports=require("@prisma/client")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},1301:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>P,originalPathname:()=>v,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>w});var a={};t.r(a),t.d(a,{POST:()=>d});var n=t(5419),o=t(9108),i=t(9678),s=t(8070),u=t(3214),p=t(2156);async function d(e){try{let{agentId:r,oldPin:t,newPin:a}=await e.json(),n=await u._.agent.findUnique({where:{id:r}});if(!n)return s.Z.json({error:"Agent not found"},{status:404});if(!await (0,p.vj)(t,n.pin))return s.Z.json({error:"Invalid old PIN"},{status:401});let o=await (0,p.xM)(a);return await u._.agent.update({where:{id:r},data:{pin:o}}),s.Z.json({success:!0})}catch(e){return console.error("PIN update error:",e),s.Z.json({error:"Failed to update PIN"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/agent/update-pin/route",pathname:"/api/agent/update-pin",filename:"route",bundlePath:"app/api/agent/update-pin/route"},resolvedPagePath:"/workspaces/APP-Final/app/api/agent/update-pin/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:g,headerHooks:P,staticGenerationBailout:w}=c,v="/api/agent/update-pin/route";function f(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},3214:(e,r,t)=>{t.d(r,{_:()=>n});var a=t(3524);let n=globalThis.prisma||new a.PrismaClient({log:["query","error","warn"]})},2156:(e,r,t)=>{t.d(r,{vj:()=>o,xM:()=>n});var a=t(5050);async function n(e){try{let r=await a.ZP.genSalt(10);return await a.ZP.hash(e,r)}catch(e){throw console.error("Error hashing PIN:",e),Error("Failed to hash PIN")}}async function o(e,r){try{return await a.ZP.compare(e,r)}catch(e){return console.error("Error verifying PIN:",e),!1}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1638,6206,7529],()=>t(1301));module.exports=a})();